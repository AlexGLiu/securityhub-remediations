



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="This hands-on workshop is where you will learn about how to implement automated remediations of findings submitted to AWS Security Hub.  You will learn about AWS services including CloudWatch Events, Cloudwatch Logs, AWS Lambda, Amazon GuardDuty, Amazon Security Hub and well as learn about using the open source tool Cloud Custodian to leverage these services.">
      
      
        <link rel="canonical" href="https://securityhubremediations.awssecworkshops.com/01-environment-setup/">
      
      
        <meta name="author" content="aws-security-workshops@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Module 1: Environment Build - Security Hub Automated Remediations</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#module-1-environment-build-and-configuration" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">

        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>

        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>

        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  Security Hub Automated Remediations
                </span>
                <span class="md-header-nav__topic">
                  Module 1: Environment Build
                </span>
              
            
          </div>
        </div>


        <!-- Button to open search dialogue -->
        <!--
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>

              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>

         -->

         <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-flex__ellipsis md-header-nav__lang">
                <div>
                    <button onclick="window.location.href = 'https://awssecworkshops.com/';" class="md-lang-dropbtn fa fa-home"></button>
                </div>
            </div>
        </div>

        <!-- Repository containing source -->
        
          <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__source">
              


  

<a href="https://github.com//FireballDWF/securityhub-remediations/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    FireballDWF/securityhub-remediations
  </div>
</a>
            </div>
          </div>
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." class="md-tabs__link md-tabs__link--active">
        Overview
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!--
  Copyright (c) 2016-2019 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

  <!-- Site title -->
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://securityhubremediations.awssecworkshops.com/"
        title="Security Hub Automated Remediations" class="md-nav__button md-logo">
      
        <img src="../assets/images/aws_smile_logo.png" width="48" height="48" />
      
    </a>
    Security Hub Remediations
  </label>

  <!-- Repository containing source -->
  
    <div class="md-nav__source">
      


  

<a href="https://github.com//FireballDWF/securityhub-remediations/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    FireballDWF/securityhub-remediations
  </div>
</a>
    </div>
  

  <!-- Render item list -->
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Module 1: Environment Build
      </label>
    
    <a href="./" title="Module 1: Environment Build" class="md-nav__link md-nav__link--active">
      Module 1: Environment Build
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started-at-aws-event-where-the-event-engine-is-being-used" class="md-nav__link">
    Getting Started at AWS event where the Event Engine is being used
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-using-your-own-account" class="md-nav__link">
    Getting Started using your own account:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-setup-steps" class="md-nav__link">
    Manual Setup Steps
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../02-guardduty-dns-event/" title="Module 2: GuardDuty DNS Event on EC2 Instance" class="md-nav__link">
      Module 2: GuardDuty DNS Event on EC2 Instance
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../03-securityhub-custom-actions/" title="Module 3: Security Hub Custom Actions" class="md-nav__link">
      Module 3: Security Hub Custom Actions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../04-ec2-instance-high-risk-config/" title="Module 4: Vulnerability Event on EC2 Instance with Very Risky Configuration" class="md-nav__link">
      Module 4: Vulnerability Event on EC2 Instance with Very Risky Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../05-guardduty-iam-user/" title="Module 5: GuardDuty Event on IAMUser" class="md-nav__link">
      Module 5: GuardDuty Event on IAMUser
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../06-ebs-snapshot-public/" title="Module 6: Remediate an Public EBS-Snapshot" class="md-nav__link">
      Module 6: Remediate an Public EBS-Snapshot
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contribute/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started-at-aws-event-where-the-event-engine-is-being-used" class="md-nav__link">
    Getting Started at AWS event where the Event Engine is being used
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-using-your-own-account" class="md-nav__link">
    Getting Started using your own account:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-setup-steps" class="md-nav__link">
    Manual Setup Steps
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/FireballDWF/securityhub-remediations/edit/master/docs/01-environment-setup.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="module-1-environment-build-and-configuration">Module 1: Environment build and configuration</h1>
<p>To Get started with this workshop as part of the an AWS Event where Event Engine is being used, please follow the steps directly following, otherwise skip down to the section labeled <a href="#getting-started-using-your-own-account">"Getting Started using your own account"</a>.</p>
<h2 id="getting-started-at-aws-event-where-the-event-engine-is-being-used">Getting Started at AWS event where the Event Engine is being used</h2>
<ol>
<li>Open https://dashboard.eventengine.run/login in a new Tab or Window to access the Event Engine Dashboard</li>
<li>Enter the team hash code that you were provided and click Proceed.</li>
<li>Look for a section of the page labeled "Event Engine Team Role" then click "Open Console" button within the Login Link section</li>
<li>Make sure you are in the correct region.</li>
<li>Skip the <a href="#getting-started-using-your-own-account">"Getting started using your own account"</a> and continue with the <a href="#manual-setup-steps">"Manual Setup Steps"</a></li>
</ol>
<h2 id="getting-started-using-your-own-account">Getting Started using your own account:</h2>
<ol>
<li>In order to complete this workshop, you'll need a valid, usable AWS Account. Use a personal account or create a new AWS account to ensure you have the necessary access and that you do not accidentally modify corporate resources. Do not use an AWS account from the company you work for unless you have explicit approval to conduct security related training exercises in it. We strongly recommend that you use a non-production AWS account for this workshop such as a training, sandbox or personal account. Attempts by multiple participants to use the same account for this workshop will fail, due to the deployment of Named IAM Roles and Users.</li>
<li>You will incur charges for the AWS resources used in this workshop.  The charges for some of the resources may be covered through the <a href="https://aws.amazon.com/free/">AWS Free Tier</a>. The demo uses free tier choices wherever possible.</li>
<li>You must run this workshop in a region support by <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html#cloud9_region">AWS Cloud9</a></li>
<li>If you choose to use an existing VPC, it needs to have connectivity thru an IGW to reach AWS public endpoints as some of the services used do not yet support VPC Endpoints.</li>
<li>
<p>Now we need to download a copy of the CloudFormation template for this Workshop.  If you don't have the program wget, use any other method you are comfortable with, such as curl or a browser.</p>
<div class="codehilite"><pre><span></span><span class="err">wget https://github.com/FireballDWF/securityhub-remediations/blob/master/module1/securityhub-remediations-workshop.yml</span>
</pre></div>


</li>
<li>
<p>Next we start to to create the cloudformation stack for the workshop, starting by opening the AWS Console, navigate to Cloudformation, click on the "Create stack" button, select the "With new resources (standard)" option, then in the "Specify template" section, click "Upload a template file", then click "Choose file", and when the File Dialog window pops up, select the file downloaded in the prior step.</p>
</li>
<li>Click Next.</li>
<li>Enter in a Stack name, for example "SecurityHubRemediations".</li>
<li>Change the value of "EventEngine" to False.</li>
<li>Change the value of VpcId to "CreateNew", unless you have a good reason to want to use an existing VPC and if so, enter the VpcId instead</li>
<li>Click the "Next" button.</li>
<li>On the "Configure stack options" page, Click the "Next" button.</li>
<li>On the "Review" page, click the checkbox to the left of "I acknowledge that AWS Cloudformation might create IAM resources with custom names", as it will.</li>
<li>Click "Create Stack"</li>
<li>Wait until the stack if finished creating before starting the next section, as the Cloud9 environment needs to be enabled before you can follow the next steps.</li>
</ol>
<h2 id="manual-setup-steps">Manual Setup Steps</h2>
<ol>
<li>Open the Cloud9 IDE which provides the ability to review files and execute commands in a browser based terminal window.  Starting from the main AWS Management Console, within the "Find Services" textbox, type "Cloud9" then hit Enter.</li>
<li>Now click the "Open IDE" button.</li>
<li>
<p>In the bottom part of the browser tab which opens up, look for a tab with a label starting with "bash", where the window contents contain "~/environment $".  This is the browser based terminal session you'll use for the rest of the workshop for any command line steps.</p>
</li>
<li>
<p>Run the following command to enable SecurityHub in the account, unless you are using your own account and know that it's already enabled. If you have full unresticted Admin Access, and get an error, then the most likely reason is that it is already enabled.</p>
<div class="codehilite"><pre><span></span><span class="err">aws securityhub enable-security-hub</span>
</pre></div>


</li>
<li>
<p>You need to have GuardDuty enabled on the account for module 2 and 5 to work, if not yet then either run the following command or follow the <a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_settingup.html#guardduty_enable-gd">steps to enable on the console</a></p>
<div class="codehilite"><pre><span></span><span class="err">aws guardduty create-detector --enable</span>
</pre></div>


</li>
<li>
<p>The next step is to get a copy of the files required for this workshop by cloning the workshop's github repo specifing the eventengine branch.</p>
<div class="codehilite"><pre><span></span><span class="err">git clone --single-branch --branch eventengineenablement https://github.com/FireballDWF/securityhub-remediations.git &amp;&amp; cd securityhub-remediations</span>
</pre></div>


</li>
<li>
<p>Next step is to pull down the latest version of the Cloud Custodian docker container image and setup the repeative part of the command line</p>
<div class="codehilite"><pre><span></span>export SECHUBWORKSHOP_CONTAINER=cloudcustodian/c7n
export CLOUDCUSTODIANDOCKERCMD=&quot;docker run -it --rm --cap-drop ALL -v /home/ec2-user/environment/securityhub-remediations:/home/custodian/securityhub-remediations:ro -v /home/ec2-user/.aws:/home/custodian/.aws:ro <span class="cp">${</span><span class="n">SECHUBWORKSHOP_CONTAINER</span><span class="cp">}</span> run --cache-period 0 -s /tmp -c&quot;
docker pull <span class="cp">${</span><span class="n">SECHUBWORKSHOP_CONTAINER</span><span class="cp">}</span>
</pre></div>


</li>
<li>
<p>This step tests the environment by invoking a Cloud Custodian Policy which reports that an ec2 instance has a vulnerability.</p>
<div class="codehilite"><pre><span></span><span class="cp">${</span><span class="n">CLOUDCUSTODIANDOCKERCMD</span><span class="cp">}</span> securityhub-remediations/module1/force-vulnerability-finding.yml
</pre></div>


<p>You should expect to see 2 output lines, one containing "count:1" and another containing "resources:1", similar to the following output.  If you get an error on "batch-import-findings" then it means SecurityHub has not been enabled.  Example output is from us-east-1, however your results should indicate the region being used for the workshop event.</p>
<div class="codehilite"><pre><span></span><span class="err">2019-08-11 16:33:57,326: custodian.policy:INFO policy:ec2-force-vulnerabilities resource:ec2 region:us-east-1 count:1 time:0.00</span>
<span class="err">2019-08-11 16:33:57,787: custodian.policy:INFO policy:ec2-force-vulnerabilities action:instancefinding resources:1 execution_time:0.46</span>
</pre></div>


</li>
</ol>
<p>Here is a breakdown of the command you just ran:</p>
<table>
<thead>
<tr>
<th>Command Line Component</th>
<th>Explaination</th>
</tr>
</thead>
<tbody>
<tr>
<td>docker run</td>
<td><a href="https://docs.docker.com/engine/reference/run/">Run</a> a <a href="https://docs.docker.com/engine/reference/commandline/cli/">docker</a> container</td>
</tr>
<tr>
<td>-it</td>
<td><a href="https://docs.docker.com/engine/reference/run/#foreground">interactive/foreground mode</a></td>
</tr>
<tr>
<td>--rm</td>
<td><a href="https://docs.docker.com/engine/reference/run/#clean-up----rm">clean up docker container when container exits</a></td>
</tr>
<tr>
<td>--cap-drop ALL</td>
<td>Drop all Linux kernel capabilities as recommended in Rule #3 of the <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Docker_Security_Cheat_Sheet.md">Docker Security Cheat Sheet</a></td>
</tr>
<tr>
<td>-v /home/ec2-user/environment/securityhub-remediations:/home/custodian/securityhub-remediations:ro</td>
<td>map the files for the workshop into the container so the cloud custodian policies are available insider the container. volume is mapped in ReadOnly mode</td>
</tr>
<tr>
<td>-v /home/ec2-user/.aws:/home/custodian/.aws:ro</td>
<td>maps the <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html">aws cli configuration files</a> into the container in read-only mode.  Cloud Custodian uses the same configuration files, as both use the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html">boto3 Python SDK</a></td>
</tr>
<tr>
<td>${SECHUBWORKSHOP_CONTAINER}</td>
<td>evaluates to cloudcustodian/c7n which is the docker container image which is downloaded from https://hub.docker.com/r/cloudcustodian/c7n</td>
</tr>
<tr>
<td>run</td>
<td>instructs Cloud Custodian to run a policy. This is the first part of the command line which is passed to CloudCustodian</td>
</tr>
<tr>
<td>--cache-period 0</td>
<td>disables cloud custodian's caching of api call results</td>
</tr>
<tr>
<td>-s /tmp</td>
<td>specifies the directory where log and resource data is placed</td>
</tr>
<tr>
<td>-c securityhub-remediations/module1/force-vulnerability-finding.yml</td>
<td>specifies the actual policy to run</td>
</tr>
</tbody>
</table>
<ol>
<li>If you received the expected output lines, congratulations, you have successfully tested the environment setup by having Cloud Custodian submit a finding to Security Hub.  Proceed to the next module.</li>
</ol>
<p>After you have successfully setup your environment, you can proceed to the next module.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </span>
            </div>
          </a>
        
        
          <a href="../02-guardduty-dns-event/" title="Module 2: GuardDuty DNS Event on EC2 Instance" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Module 2: GuardDuty DNS Event on EC2 Instance
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2020, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://awssecworkshops.com" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/security/" class="md-footer-social__link fa fa-shield"></a>
    
      <a href="https://twitter.com/awssecurityinfo?lang=en" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://aws.amazon.com/blogs/security/" class="md-footer-social__link fa fa-rss"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>